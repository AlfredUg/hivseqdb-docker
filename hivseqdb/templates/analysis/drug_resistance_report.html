<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
  <title>Drug resistance report for {{ seqName }} </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
	<!-- contents -->
    <div class="container" style="overflow-x:auto;">
    
    <div class="p-3" align="center">
        <img src="{% static 'base/mrc.png' %}" height="100px" width="50%">
    </div>

    <div class="p-3 rounded">
        <div class="p-3 mb-2 bg-info text-white" align="center"><h2>HIV Drug Resistance Report</h2></div>  
    </div>

    <div class="p-3 rounded">
        <p>This report is generated by HIVseqDB application for drug resistance interpretation which is based on the current version of HIVDB algorithm. This report is generated by HIVseqDB application for drug resistance interpretation
        which is based on the current version of HIVDB algorithm. This report is generated by HIVseqDB application for drug resistance interpretation
        which is based on the current version of HIVDB algorithm.</p>    
    </div>
    <!-- Basic info -->
    <div class="p-3 rounded">
        <div class="p-3 mb-2 bg-info text-white"><h4>Basic information</h4></div>
        <!-- Sequence name -->
        <p>  Sequence name: {{ seqName }} </p>
        <!-- Subtype -->
        <p> Subtype: {{ subType }} </p>
        <!-- Algorithm -->
        <p> HIVdb algorithm version: {{ algorithm }} </p>
        <!-- Turn around time -->
        <p> Estimated turn around time: {{ time }} </p>

    <!-- Gene ranges -->
    <h6>Gene ranges: </h6>
    <table class="table table-striped col-6">
        <thead>
            <tr>
                <th>Gene name</th>
                <th>First amino acid</th>
                <th>Last amino  acid</th>
            </tr>
        </thead>
        <tbody>
        <!-- Remember, for panda dataframe we need to use the itertuples methods to use the dot notation for calling colnames -->
        {% for gene_range in genes_ranges.itertuples %} 
        <tr>
            <td>{{ gene_range.gene }}</td>
            <td>{{ gene_range.firstAA }}</td>
            <td>{{ gene_range.lastAA }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <p>PR: Protease, RT: Reverse Transcriptase, IN: Integrase</p>
    </div>
    <!-- Drug resistance scores -->
    <div class="p-3 rounded">
        <!-- Columns are always 50% wide, on mobile and desktop -->
        <div class="p-3 mb-2 bg-info text-white"><h4>Drug resistance interpretation: PR</h4></div>  
        <p>Major Mutations: {{ PI_major }}</p>
        <p>Minor Mutations: {{ PI_accessory }}</p>
        <p>PR Other Mutations: </p>           
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Drug Name</th>
                        <th>Susceptibility</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Remember, for panda dataframe we need to use the itertuples methods to use the dot notation for calling colnames -->
                    {% for record in dr_PI.itertuples %} 
                    <tr>
                        <td>{{record.DrugDisplayAbbr}}</td>    
                        <td>{{record.Susceptibility}}</td>    
                        <td>{{record.Score}}</td>    
                    </tr> 
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <!-- NNRTIs -->

        <div class="p-3 rounded">
            <div class="p-3 mb-2 bg-info text-white"><h4>Drug resistance interpretation: RT</h4></div>             
            <p>NRTI Mutations: {{ NRTI_muts }} </p>
            <p>NNRTI Mutations: {{ NNRTI_muts }} </p>
            <p>RT Other Mutations: </p>           
            <h5> Drug resistance mutation scoring: NRTI </h5>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Drug Name</th>
                        <th>Susceptibility</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Remember, for panda dataframe we need to use the itertuples methods to use the dot notation for calling colnames -->
                    {% for record in dr_NRTI.itertuples %} 
                    <tr>
                        <td>{{record.DrugDisplayAbbr}}</td>    
                        <td>{{record.Susceptibility}}</td>    
                        <td>{{record.Score}}</td>    
                    </tr> 
                    {% endfor %}
                </tbody>
            </table>

    <!-- Columns are always 50% wide, on mobile and desktop -->
            <h5> Drug resistance mutation scoring: NNRTI </h5>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Drug Name</th>
                        <th>Susceptibility</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Remember, for panda dataframe we need to use the itertuples methods to use the dot notation for calling colnames -->
                    {% for record in dr_NNRTI.itertuples %} 
                    <tr>
                        <td>{{record.DrugDisplayAbbr}}</td>    
                        <td>{{record.Susceptibility}}</td>    
                        <td>{{record.Score}}</td>    
                    </tr> 
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="p-3 rounded">
            <div class="p-3 mb-2 bg-info text-white"><h4>Drug resistance interpretation: IN</h4></div>             
            <p>Major Mutations: {{ INSTI_major }} </p>
            <p>Accessory Mutations: {{ INSTI_accessory }} </p>
            <p>IN Other Mutations: </p>   
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Drug Name</th>
                        <th>Susceptibility</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Remember, for panda dataframe we need to use the itertuples methods to use the dot notation for calling colnames -->
                    {% for record in dr_INSTI.itertuples %} 
                    <tr>
                        <td>{{record.DrugDisplayAbbr}}</td>    
                        <td>{{record.Susceptibility}}</td>    
                        <td>{{record.Score}}</td>    
                    </tr> 
                    {% endfor %}
                </tbody>
            </table>
    </div>

    <div class="p-3 rounded">
        <!-- Comments -->
    <div class="p-3 mb-2 bg-info text-white"><h4>Comment(s)</h4></div>
    <hr>
    {% for comment in comments %} 
        <ul>{{ comment|safe }}</ul>
    {% endfor %}
    </div>
    <div class="p-3 mb-2 bg-info text-white"><h4>References</h4></div>
    <hr>
        <ul>Ho, Jasper C, Garway T Ng, Mathias Renaud, et al. 2019. “Sierra-Local: A Lightweight Standalone Application for Drug Resistance Prediction.” Journal of Open Source Software 4 (33): 1186.</ul>
        <ul>Marinier, Eric, Eric Enns, Camy Tran, Matthew Fogel, Cole Peters, Ahmed Kidwai, Hezhao Ji, and Gary Van Domselaar. 2019. “Quasitools: A Collection of Tools for Viral Quasispecies Analysis.” BioRxiv, 733238.</ul>
    </div>
    </div>
	</body>
</html>